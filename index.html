<!DOCTYPE html>
<html>
    <head>
        <title>FastAPI Chat Test</title>
        <style>
            body { font-family: sans-serif; margin: 20px; }
            #messages { border: 1px solid #ccc; height: 300px; overflow-y: scroll; padding: 10px; margin-bottom: 10px; }
            .status { color: gray; font-style: italic; }
        </style>
    </head>
    <body>
        <h2>Кімната: <span id="room-id-display">...</span></h2>
        <div id="messages"></div>
        <input type="text" id="messageText" autocomplete="off" placeholder="Напишіть повідомлення..."/>
        <button onclick="sendMessage()">Надіслати</button>

        <script>
            // Параметри для тестування (можна міняти вручну)
            const roomId = "room_1"; 
            const clientId = "User_" + Math.floor(Math.random() * 1000);
            document.getElementById('room-id-display').innerText = roomId;

            // Підключення до твого FastAPI серверу
            const ws = new WebSocket(`wss://chat-1-bwxb.onrender.com/ws/${roomId}/${clientId}`);

            ws.onmessage = function(event) {
                const messages = document.getElementById('messages');
                const message = document.createElement('div');
                message.textContent = event.data;
                messages.appendChild(message);
                messages.scrollTop = messages.scrollHeight; // Автопрокрутка вниз
            };

            ws.onclose = function(event) {
                const messages = document.getElementById('messages');
                const status = document.createElement('div');
                status.className = 'status';
                status.textContent = "З'єднання розірвано: " + event.reason;
                messages.appendChild(status);
            };

            function sendMessage() {
                const input = document.getElementById("messageText");
                ws.send(input.value);
                input.value = '';
            }
        </script>
    </body>
</html>
